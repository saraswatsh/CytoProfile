% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cyt.plsda.R
\name{cyt.plsda}
\alias{cyt.plsda}
\title{Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA).}
\usage{
cyt.plsda(
  data,
  group.col = NULL,
  trt.col = NULL,
  colors = NULL,
  title,
  ellipse = FALSE,
  bg = FALSE,
  conf.mat = FALSE,
  var.num,
  cv.opt = NULL,
  fold.num = 5,
  scale = NULL,
  comp.num = 2,
  pch.values,
  style = NULL,
  roc = FALSE
)
}
\arguments{
\item{data}{A matrix or data frame containing the variables. Columns not specified by \code{group.col} or \code{trt.col} are assumed to be continuous variables for analysis.}

\item{group.col}{A string specifying the column name that contains group information. If \code{trt.col} is not provided, it will be used for both grouping and treatment.}

\item{trt.col}{A string specifying the column name for treatments. Default is \code{NULL}.}

\item{colors}{A vector of colors for the groups or treatments. If \code{NULL}, a random palette (using \code{rainbow}) is generated based on the number of groups.}

\item{title}{A string specifying the file name for saving the PDF output.}

\item{ellipse}{Logical. Whether to draw a 95\% confidence ellipse on the figures. Default is \code{FALSE}.}

\item{bg}{Logical. Whether to draw the prediction background in the figures. Default is \code{FALSE}.}

\item{conf.mat}{Logical. Whether to print the confusion matrix for the classifications. Default is \code{FALSE}.}

\item{var.num}{Numeric. The number of variables to be used in the PLS-DA model.}

\item{cv.opt}{Character. Option for cross-validation method: either "loocv" or "Mfold". Default is \code{NULL}.}

\item{fold.num}{Numeric. The number of folds to use if \code{cv.opt} is "Mfold". Default is 5.}

\item{scale}{Character. Option for data transformation; if set to \code{"log2"}, a log2 transformation is applied to the continuous variables. Default is \code{NULL}.}

\item{comp.num}{Numeric. The number of components to calculate in the sPLS-DA model. Default is 2.}

\item{pch.values}{A vector of integers specifying the plotting characters to be used in the plots.}

\item{style}{Character. If set to \code{"3D"} or \code{"3d"} and \code{comp.num} equals 3, a 3D plot is generated using the \code{plot3D} package. Default is \code{NULL}.}

\item{roc}{Logical. Whether to compute and plot the ROC curve for the model. Default is \code{FALSE}.}
}
\value{
A PDF file containing the classification figures, component figures with Variable of Importance in Projection (VIP) scores,
and classifications based on VIP scores greater than 1. ROC curves and confusion matrices are also produced if requested.
}
\description{
This function conducts Sparse Partial Least Squares Discriminant Analysis (sPLS-DA) on the provided data.
It uses the specified \code{group.col} (and optionally \code{trt.col}) to define class labels while assuming the remaining columns
contain continuous variables. The function supports a log2 transformation via the \code{scale} parameter and generates a series of plots,
including classification plots, scree plots, loadings plots, and VIP score plots. Optionally, ROC curves are produced when \code{roc} is \code{TRUE}.
Additionally, cross-validation is supported via LOOCV or Mfold methods. When both \code{group.col} and \code{trt.col} are provided and differ,
the function analyzes each treatment level separately.
}
\examples{
\dontrun{
# Example using overall analysis (single factor)
cyt.plsda(
  data = my_data, group.col = "Group", title = "PLSDA_overall.pdf",
  var.num = 25, pch.values = c(16, 4, 3)
)

# Example using separate group and treatment columns
cyt.plsda(
  data = my_data, group.col = "Group", trt.col = "Treatment",
  title = "PLSDA_byTreatment.pdf",
  colors = c("black", "purple", "red2"), ellipse = TRUE, bg = TRUE, conf.mat = TRUE,
  var.num = 25, cv.opt = "loocv", comp.num = 2, pch.values = c(16, 4, 3)
)

# Example with ROC curve and 3D plot (comp.num == 3)
cyt.plsda(
  data = my_data, group.col = "Group", trt.col = "Treatment",
  title = "PLSDA_ROC_3D.pdf", colors = c("black", "purple", "red2"),
  ellipse = TRUE, bg = TRUE, conf.mat = TRUE,
  var.num = 25, cv.opt = "Mfold", fold.num = 5, scale = "log2", comp.num = 3,
  pch.values = c(16, 4, 3), style = "3D", roc = TRUE
)
}

}
