<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Volcano plot — cyt_volc • CytoProfile</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Volcano plot — cyt_volc"><meta name="description" content="This function subsets the numeric columns from the input data
and compares them based on a selected grouping column. It computes the fold
changes (as the ratio of means) and associated p-values for each numeric variable
between two groups. The results are log2-transformed (for fold change) and
-log10-transformed (for p-values) to generate a volcano plot. Additionally,
there is a choice between t‑tests and Wilcoxon rank‑sum tests and adjusting
p‑values for multiple comparisons."><meta property="og:description" content="This function subsets the numeric columns from the input data
and compares them based on a selected grouping column. It computes the fold
changes (as the ratio of means) and associated p-values for each numeric variable
between two groups. The results are log2-transformed (for fold change) and
-log10-transformed (for p-values) to generate a volcano plot. Additionally,
there is a choice between t‑tests and Wilcoxon rank‑sum tests and adjusting
p‑values for multiple comparisons."><meta property="og:image" content="https://cytoprofile.cytokineprofile.org/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoProfile</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saraswatsh/CytoProfile/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Volcano plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/saraswatsh/CytoProfile/blob/devel/R/cyt_volc.R" class="external-link"><code>R/cyt_volc.R</code></a></small>
      <div class="d-none name"><code>cyt_volc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function subsets the numeric columns from the input data
and compares them based on a selected grouping column. It computes the fold
changes (as the ratio of means) and associated p-values for each numeric variable
between two groups. The results are log2-transformed (for fold change) and
-log10-transformed (for p-values) to generate a volcano plot. Additionally,
there is a choice between t‑tests and Wilcoxon rank‑sum tests and adjusting
p‑values for multiple comparisons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cyt_volc</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  cond1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cond2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fold_change_thresh <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  p_value_thresh <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  top_labels <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ttest"</span>, <span class="st">"wilcox"</span><span class="op">)</span>,</span>
<span>  p_adjust_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing numeric variables and a
grouping column.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>Character.  Name of the grouping column.</p></dd>


<dt id="arg-cond-">cond1<a class="anchor" aria-label="anchor" href="#arg-cond-"></a></dt>
<dd><p>Character string specifying the level of <code>group_col</code>
for the first condition to compare.</p></dd>


<dt id="arg-cond-">cond2<a class="anchor" aria-label="anchor" href="#arg-cond-"></a></dt>
<dd><p>Character strings specifying the second level of
<code>group_col</code> to compare with <code>cond1</code>.</p></dd>


<dt id="arg-fold-change-thresh">fold_change_thresh<a class="anchor" aria-label="anchor" href="#arg-fold-change-thresh"></a></dt>
<dd><p>Numeric.  Threshold for absolute fold
change (in original scale).  Default is 2.</p></dd>


<dt id="arg-p-value-thresh">p_value_thresh<a class="anchor" aria-label="anchor" href="#arg-p-value-thresh"></a></dt>
<dd><p>Numeric.  Threshold for the p‑value (raw or
adjusted).  Default is 0.05.</p></dd>


<dt id="arg-top-labels">top_labels<a class="anchor" aria-label="anchor" href="#arg-top-labels"></a></dt>
<dd><p>Integer.  Number of top points to label in each
plot.  Default is 10.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character.  Statistical test to use.  "ttest" (default)
uses two‑sample t‑tests; "wilcox" uses Wilcoxon rank‑sum tests.</p></dd>


<dt id="arg-p-adjust-method">p_adjust_method<a class="anchor" aria-label="anchor" href="#arg-p-adjust-method"></a></dt>
<dd><p>Character or <code>NULL</code>.  Method to adjust
p‑values across variables within each comparison (e.g., "BH").
If <code>NULL</code> (default) no adjustment is performed. See <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>
for details.</p></dd>


<dt id="arg-add-effect">add_effect<a class="anchor" aria-label="anchor" href="#arg-add-effect"></a></dt>
<dd><p>Logical.  If <code>TRUE</code>, effect sizes are computed and
returned in the results (Cohen's d for t‑tests; rank‑biserial for
Wilcoxon).  Default is <code>FALSE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical.  If <code>TRUE</code>, prints the data frame used for
the final comparison without the label column.  Default is
<code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of ggplot objects (one per comparison).  Each plot
visualizes log2 fold change on the x‑axis and –log10 of the
(adjusted) p‑value on the y‑axis.  The underlying data used to
construct the final plot are printed when <code>verbose = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If <code>cond1</code> and <code>cond2</code> are not provided, the function
automatically generates all possible pairwise combinations of groups from
the specified <code>group_col</code> for comparisons.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Xiaohua Douglas Zhang and Shubh Saraswat</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Loading data</span></span></span>
<span class="r-in"><span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">ExampleData1</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cyt_volc</span><span class="op">(</span><span class="va">data_df</span>, <span class="st">"Group"</span>, cond1 <span class="op">=</span> <span class="st">"T2D"</span>, cond2 <span class="op">=</span> <span class="st">"ND"</span>, fold_change_thresh <span class="op">=</span> <span class="fl">2.0</span>, top_labels<span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`T2D vs ND`</span>
<span class="r-plt img"><img src="cyt_volc-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shubh Saraswat, Xiaohua Douglas Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

