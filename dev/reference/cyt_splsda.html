<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA). — cyt_splsda • CytoProfile</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA). — cyt_splsda"><meta name="description" content="This function conducts Sparse Partial Least Squares Discriminant Analysis
(sPLS-DA) on the provided data. It uses the specified group_col (and
optionally group_col2) to define class labels while assuming the remaining
columns contain continuous variables. The function supports a log2
transformation via the scale parameter and generates a series of plots,
including classification plots, scree plots, loadings plots, and VIP score
plots. Optionally, ROC curves are produced when roc is TRUE.
Additionally, cross-validation is supported via LOOCV or Mfold methods. When
both group_col and group_col2 are provided and differ, the function
analyzes each treatment level separately."><meta property="og:description" content="This function conducts Sparse Partial Least Squares Discriminant Analysis
(sPLS-DA) on the provided data. It uses the specified group_col (and
optionally group_col2) to define class labels while assuming the remaining
columns contain continuous variables. The function supports a log2
transformation via the scale parameter and generates a series of plots,
including classification plots, scree plots, loadings plots, and VIP score
plots. Optionally, ROC curves are produced when roc is TRUE.
Additionally, cross-validation is supported via LOOCV or Mfold methods. When
both group_col and group_col2 are provided and differ, the function
analyzes each treatment level separately."><meta property="og:image" content="https://cytoprofile.cytokineprofile.org/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoProfile</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saraswatsh/CytoProfile/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA).</h1>
      <small class="dont-index">Source: <a href="https://github.com/saraswatsh/CytoProfile/blob/main/R/cyt_splsda.R" class="external-link"><code>R/cyt_splsda.R</code></a></small>
      <div class="d-none name"><code>cyt_splsda.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function conducts Sparse Partial Least Squares Discriminant Analysis
(sPLS-DA) on the provided data. It uses the specified <code>group_col</code> (and
optionally <code>group_col2</code>) to define class labels while assuming the remaining
columns contain continuous variables. The function supports a log2
transformation via the <code>scale</code> parameter and generates a series of plots,
including classification plots, scree plots, loadings plots, and VIP score
plots. Optionally, ROC curves are produced when <code>roc</code> is <code>TRUE</code>.
Additionally, cross-validation is supported via LOOCV or Mfold methods. When
both <code>group_col</code> and <code>group_col2</code> are provided and differ, the function
analyzes each treatment level separately.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cyt_splsda</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  group_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_col2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  multilevel_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  batch_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ind_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pdf_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ellipse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf_mat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">var_num</span>,</span>
<span>  cv_opt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fold_num <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp_num <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">pch_values</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  roc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix or data frame containing the variables. Columns not
specified by <code>group_col</code> or <code>group_col2</code> are assumed to be continuous
variables for analysis.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>A string specifying the column name that contains the first group
information. If <code>group_col2</code> is not provided, an overall analysis will
be performed.</p></dd>


<dt id="arg-group-col-">group_col2<a class="anchor" aria-label="anchor" href="#arg-group-col-"></a></dt>
<dd><p>A string specifying the second grouping column. Default is
<code>NULL</code>.</p></dd>


<dt id="arg-multilevel-col">multilevel_col<a class="anchor" aria-label="anchor" href="#arg-multilevel-col"></a></dt>
<dd><p>A string specifying the column name that identifies
repeated measurements (e.g., patient or sample IDs). If provided, a
multilevel analysis will be performed. Default is <code>NULL</code>.</p></dd>


<dt id="arg-batch-col">batch_col<a class="anchor" aria-label="anchor" href="#arg-batch-col"></a></dt>
<dd><p>A string specifying the column that identifies the batch or study for each sample.</p></dd>


<dt id="arg-ind-names">ind_names<a class="anchor" aria-label="anchor" href="#arg-ind-names"></a></dt>
<dd><p>If <code>TRUE</code>, the row names of the first (or second) data matrix is used as names.
Default is <code>FALSE</code>. If a character vector is provided, these values will be used as names.
If 'pch' is set this will overwrite the names as shapes. See ?mixOmics::plotIndiv for details.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>A vector of colors for the groups or treatments. If
<code>NULL</code>, a random palette (using <code>rainbow</code>) is generated based on
the number of groups.</p></dd>


<dt id="arg-pdf-title">pdf_title<a class="anchor" aria-label="anchor" href="#arg-pdf-title"></a></dt>
<dd><p>A string specifying the file name for saving the PDF output.
Default is <code>NULL</code> which generates figures in the current graphics device.</p></dd>


<dt id="arg-ellipse">ellipse<a class="anchor" aria-label="anchor" href="#arg-ellipse"></a></dt>
<dd><p>Logical. Whether to draw a 95\<!-- % confidence ellipse on the -->
figures. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-bg">bg<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>Logical. Whether to draw the prediction background in the figures.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-conf-mat">conf_mat<a class="anchor" aria-label="anchor" href="#arg-conf-mat"></a></dt>
<dd><p>Logical. Whether to print the confusion matrix for the
classifications. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-var-num">var_num<a class="anchor" aria-label="anchor" href="#arg-var-num"></a></dt>
<dd><p>Numeric. The number of variables to be used in the PLS-DA model.</p></dd>


<dt id="arg-cv-opt">cv_opt<a class="anchor" aria-label="anchor" href="#arg-cv-opt"></a></dt>
<dd><p>Character. Option for cross-validation method: either
"loocv" or "Mfold". Default is <code>NULL</code>.</p></dd>


<dt id="arg-fold-num">fold_num<a class="anchor" aria-label="anchor" href="#arg-fold-num"></a></dt>
<dd><p>Numeric. The number of folds to use if <code>cv_opt</code> is
"Mfold". Default is 5.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Character. Option for data transformation; if set to
<code>"log2"</code>, a log2 transformation is applied to the continuous
variables. Default is <code>NULL</code>.</p></dd>


<dt id="arg-comp-num">comp_num<a class="anchor" aria-label="anchor" href="#arg-comp-num"></a></dt>
<dd><p>Numeric. The number of components to calculate in the sPLS-DA
model. Default is 2.</p></dd>


<dt id="arg-pch-values">pch_values<a class="anchor" aria-label="anchor" href="#arg-pch-values"></a></dt>
<dd><p>A vector of integers specifying the plotting characters
(pch values) to be used in the plots.</p></dd>


<dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>Character. If set to <code>"3D"</code> or <code>"3d"</code> and
<code>comp_num</code> equals 3, a 3D plot is generated using the
<code>plot3D</code> package. Default is <code>NULL</code>.</p></dd>


<dt id="arg-roc">roc<a class="anchor" aria-label="anchor" href="#arg-roc"></a></dt>
<dd><p>Logical. Whether to compute and plot the ROC curve for the model.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value indicating whether to print additional
informational output to the console. When <code>TRUE</code>, the function will
display progress messages, and intermediate results when
<code>FALSE</code> (the default), it runs quietly.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer specifying the seed for reproducibility (default is 123).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Plots consisting of the classification figures, component figures
with Variable of Importance in Projection (VIP) scores, and classifications
based on VIP scores greater than 1. ROC curves and confusion matrices are also
produced if requested.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When <code>verbose</code> is set to <code>TRUE</code>, additional information about the analysis and confusion matrices
are printed to the console. These can be suppressed by keeping <code>verbose = FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lê Cao, K.-A., Boitard, S. and Besse, P. (2011).
Sparse PLS Discriminant Analysis: biologically relevant feature selection
and graphical displays for multiclass problems. <em>BMC Bioinformatics</em>
<b>12</b>:253.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Xiaohua Douglas Zhang and Shubh Saraswat</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Loading Sample Data</span></span></span>
<span class="r-in"><span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">ExampleData1</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="va">Group</span> <span class="op">!=</span> <span class="st">"ND"</span>, <span class="va">Treatment</span> <span class="op">!=</span> <span class="st">"Unstimulated"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cyt_splsda</span><span class="op">(</span><span class="va">data_df</span>, pdf_title <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"purple"</span><span class="op">)</span>, bg <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="st">"log2"</span>,</span></span>
<span class="r-in"><span>conf_mat <span class="op">=</span> <span class="cn">FALSE</span>, var_num <span class="op">=</span> <span class="fl">25</span>, cv_opt <span class="op">=</span> <span class="cn">NULL</span>, comp_num <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>pch_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span>, style <span class="op">=</span> <span class="cn">NULL</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>group_col <span class="op">=</span> <span class="st">"Group"</span>, group_col2 <span class="op">=</span> <span class="st">"Treatment"</span>, roc <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>the standard deviation is zero</span>
<span class="r-plt img"><img src="cyt_splsda-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-8.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>the standard deviation is zero</span>
<span class="r-plt img"><img src="cyt_splsda-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-13.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-14.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-15.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cyt_splsda-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shubh Saraswat, Xiaohua Douglas Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

