<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with CytoProfile â€¢ CytoProfile</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with CytoProfile">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoProfile</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saraswatsh/CytoProfile/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with CytoProfile</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/saraswatsh/CytoProfile/blob/main/vignettes/getting_started.Rmd" class="external-link"><code>vignettes/getting_started.Rmd</code></a></small>
      <div class="d-none name"><code>getting_started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="cytoprofile">CytoProfile<a class="anchor" aria-label="anchor" href="#cytoprofile"></a>
</h2>
<p>The goal of CytoProfile is to conduct quality control using
biological meaningful cutoff on raw measured values of cytokines.
Specifically, test on distributional symmetry to suggest the adopt of
transformation. Conduct exploratory analysis including summary
statistics, generate enriched barplots, and boxplots. Further, conduct
univariate analysis and multivariate analysis for advance analysis.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Before installation of the CytoProfile package, make sure to install
BiocManager and mix0mics packages using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install BiocManager</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span> </span>
<span><span class="co">## install mixOmics </span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">'mixOmics'</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of CytoProfile from <a href="https://github.com/saraswatsh/CytoProfile" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"saraswatsh/CytoProfile"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Below are examples of using the functions provided in CytoProfile.
Any saved or generated files that are PDF or PNG format will be found at
in the <a href="https://github.com/saraswatsh/CytoProfile/tree/main/output" class="external-link">Output
Folder</a>.</p>
</div>
<div class="section level3">
<h3 id="data-loading-and-set-up">1. Data Loading and set up<a class="anchor" aria-label="anchor" href="#data-loading-and-set-up"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading all packages required</span></span>
<span><span class="co"># Data manipulation and reshaping</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>       <span class="co"># For data filtering, grouping, and summarising.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>       <span class="co"># For reshaping data (e.g., pivot_longer, pivot_wider).</span></span>
<span></span>
<span><span class="co"># Plotting and visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>     <span class="co"># For creating all the ggplot-based visualizations.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>   <span class="co"># For arranging multiple plots on a single page.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span>     <span class="co"># For improved label placement in plots (e.g., volcano plots).</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/talgalili/gplots" class="external-link">gplots</a></span><span class="op">)</span>      <span class="co"># For heatmap.2, which is used to generate heatmaps.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plot3D</span><span class="op">)</span>      <span class="co"># For creating 3D scatter plots in PCA and sPLS-DA analyses.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span>    <span class="co"># For data transformation (e.g., melt) in cross-validation plots.</span></span>
<span></span>
<span><span class="co"># Statistical analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.mixOmics.org" class="external-link">mixOmics</a></span><span class="op">)</span>    <span class="co"># For multivariate analyses (PCA, sPLS-DA, etc.).</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">moments</a></span><span class="op">)</span>     <span class="co"># For computing skewness and kurtosis.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/" class="external-link">pROC</a></span><span class="op">)</span>        <span class="co"># For ROC curve generation in machine learning model evaluation.</span></span>
<span></span>
<span><span class="co"># Machine learning</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost" class="external-link">xgboost</a></span><span class="op">)</span>     <span class="co"># For building XGBoost classification models.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span> <span class="co"># For building Random Forest classification models.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span>       <span class="co"># For cross-validation and other machine learning utilities.</span></span>
<span></span>
<span><span class="co"># Package development and document rendering</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>       <span class="co"># For knitting RMarkdown files and setting chunk options.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span>    <span class="co"># For installing the development version of the package from GitHub.</span></span>
<span></span>
<span><span class="co"># devtools::install_github("saraswatsh/CytoProfile")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/saraswatsh/CytoProfile" class="external-link">CytoProfile</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loading in data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cytodata"</span><span class="op">)</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploratory-data-analysis">2. Exploratory Data Analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h3>
<div class="section level4">
<h4 id="boxplots">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating boxplots to check for outliers for raw values</span></span>
<span><span class="co"># Generating boxplots to check for outliers for raw values</span></span>
<span><span class="fu"><a href="../reference/cyt_bp.html">cyt_bp</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       pdf_title <span class="op">=</span> <span class="st">"boxplot_by_cytokine_raw.pdf"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span>
<span><span class="co"># Removing the first 4 columns to retain only continuous variables.</span></span>
<span></span>
<span><span class="co"># Generating boxplots to check for outliers for log2 values</span></span>
<span><span class="fu"><a href="../reference/cyt_bp.html">cyt_bp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>       pdf_title <span class="op">=</span> <span class="st">"boxplot_by_cytokine_log2.pdf"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span>
<span><span class="co"># Using log2 transformation for cytokine values.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="group-specific-boxplots">Group-Specific Boxplots<a class="anchor" aria-label="anchor" href="#group-specific-boxplots"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Raw values for group-specific boxplots</span></span>
<span><span class="fu"><a href="../reference/cyt_bp2.html">cyt_bp2</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>        pdf_title <span class="op">=</span> <span class="st">"boxplot_by_group_and_treatment_raw.pdf"</span>, </span>
<span>        scale <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span>
<span></span>
<span><span class="co"># Log2-transformed group-specific boxplots</span></span>
<span><span class="fu"><a href="../reference/cyt_bp2.html">cyt_bp2</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>        pdf_title <span class="op">=</span> <span class="st">"boxplot_by_group_and_treatment_log2.pdf"</span>, </span>
<span>        scale <span class="op">=</span> <span class="st">"log2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="skewness-and-kurtosis">3. Skewness and Kurtosis<a class="anchor" aria-label="anchor" href="#skewness-and-kurtosis"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histogram of skewness and kurtosis for overall raw data</span></span>
<span><span class="fu"><a href="../reference/cyt_skku.html">cyt_skku</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>         pdf_title <span class="op">=</span> <span class="st">"skew_and_kurtosis.pdf"</span>, </span>
<span>         group_cols <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram of skewness and kurtosis with grouping (e.g., "Group")</span></span>
<span><span class="fu"><a href="../reference/cyt_skku.html">cyt_skku</a></span><span class="op">(</span><span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>         pdf_title <span class="op">=</span> <span class="st">"skew_and_kurtosis_2.pdf"</span>, </span>
<span>         group_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="error-bar-plots">4. Error Bar Plots<a class="anchor" aria-label="anchor" href="#error-bar-plots"></a>
</h3>
<div class="section level4">
<h4 id="basic-error-bar-plot">Basic Error Bar Plot<a class="anchor" aria-label="anchor" href="#basic-error-bar-plot"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating basic error bar plots</span></span>
<span><span class="va">cytokine_mat</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Extract all cytokines</span></span>
<span><span class="va">cytokineNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cytokine_mat</span><span class="op">)</span>  <span class="co"># Extract cytokine names</span></span>
<span><span class="va">nCytokine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cytokineNames</span><span class="op">)</span>  <span class="co"># Total number of cytokines</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_skku.html">cyt_skku</a></span><span class="op">(</span><span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, print_res_log <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    group_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Treatment"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"bar_error_plot.pdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nCytokine</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">center_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span><span class="op">)</span>, <span class="va">results</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/cyt_errbp.html">cyt_errbp</a></span><span class="op">(</span><span class="va">center_df</span>,</span>
<span>  p_lab <span class="op">=</span> <span class="cn">FALSE</span>, es_lab <span class="op">=</span> <span class="cn">FALSE</span>, class_symbol <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="st">"Concentration in log2 scale"</span>, main <span class="op">=</span> <span class="va">cytokineNames</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="enriched-error-bar-plot-with-p-values-and-effect-sizes">Enriched Error Bar Plot with p-values and Effect Sizes<a class="anchor" aria-label="anchor" href="#enriched-error-bar-plot-with-p-values-and-effect-sizes"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating Error Bar Plot enriched with p-value and effect size </span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">cyt_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">data_df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">cyt_mat</span><span class="op">)</span></span>
<span><span class="va">cytokineNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cyt_mat</span><span class="op">)</span></span>
<span><span class="va">nCytokine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cytokineNames</span><span class="op">)</span></span>
<span><span class="va">condt</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cyt_mat</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">cyt_mat</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">Cutoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cyt_mat</span><span class="op">[</span><span class="va">condt</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Create matrices for ANOVA and Tukey results</span></span>
<span><span class="va">p_aov_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">nCytokine</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">p_aov_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cytokineNames</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Treatment"</span>, <span class="st">"Interaction"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p_groupComp_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">nCytokine</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">p_groupComp_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cytokineNames</span>, </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2-1"</span>, <span class="st">"3-1"</span>, <span class="st">"3-2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ssmd_groupComp_stm_mat</span> <span class="op">&lt;-</span> <span class="va">mD_groupComp_stm_mat</span> <span class="op">&lt;-</span> <span class="va">p_groupComp_stm_mat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">p_groupComp_mat</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nCytokine</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Cytokine</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cyt_mat</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">Cutoff</span><span class="op">)</span></span>
<span>  <span class="va">cytokine_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Cytokine</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">*</span> <span class="va">Treatment</span>, data <span class="op">=</span> <span class="va">data_df</span><span class="op">)</span></span>
<span>  <span class="va">aov_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cytokine_aov</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">p_aov_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">aov_table</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">]</span></span>
<span>  <span class="va">p_groupComp_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">cytokine_aov</span><span class="op">)</span><span class="op">$</span><span class="va">Group</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="va">p_groupComp_stm_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">cytokine_aov</span><span class="op">)</span><span class="op">$</span><span class="va">`Group:Treatment`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="va">mD_groupComp_stm_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">cytokine_aov</span><span class="op">)</span><span class="op">$</span><span class="va">`Group:Treatment`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">ssmd_groupComp_stm_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mD_groupComp_stm_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">/</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">aov_table</span><span class="op">[</span><span class="st">"Residuals"</span>, <span class="st">"Mean Sq"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_skku.html">cyt_skku</a></span><span class="op">(</span><span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, print_res_log <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    group_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Treatment"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"bar_error_plot_enriched.pdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nCytokine</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result_mat</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, , <span class="va">k</span><span class="op">]</span></span>
<span>  <span class="va">center_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">result_mat</span><span class="op">)</span>,</span>
<span>    <span class="va">result_mat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"spread"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p_groupComp_stm_mat</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    effect.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ssmd_groupComp_stm_mat</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/cyt_errbp.html">cyt_errbp</a></span><span class="op">(</span><span class="va">center_df</span>, p_lab <span class="op">=</span> <span class="cn">TRUE</span>, es_lab <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            class_symbol <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            y_lab <span class="op">=</span> <span class="st">"Concentration in log2 scale"</span>, </span>
<span>            main <span class="op">=</span> <span class="va">cytokineNames</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="univariate-analysis">5. Univariate Analysis<a class="anchor" aria-label="anchor" href="#univariate-analysis"></a>
</h3>
<div class="section level4">
<h4 id="two-sample-t-test-and-mann-whitney-u-test">Two Sample T-test and Mann Whitney U Test<a class="anchor" aria-label="anchor" href="#two-sample-t-test-and-mann-whitney-u-test"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Performing Two Sample T-test and Mann Whitney U Test</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="va">Group</span> <span class="op">!=</span> <span class="st">"ND"</span>, <span class="va">Treatment</span> <span class="op">!=</span> <span class="st">"Unstimulated"</span><span class="op">)</span></span>
<span><span class="co"># Two sample T-test</span></span>
<span><span class="fu"><a href="../reference/cyt_ttest.html">cyt_ttest</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>, scale <span class="op">=</span> <span class="st">"log2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; T-test p-value for PreT2D vs T2D on IFN.G: 0.02082</span></span>
<span><span class="co">#&gt; T-test p-value for PreT2D vs T2D on IL.10: 0.02484</span></span>
<span><span class="co">#&gt; T-test p-value for CD3/CD28 vs LPS on IFN.G: 7.31e-22</span></span>
<span><span class="co">#&gt; T-test p-value for CD3/CD28 vs LPS on IL.10: 0.0001402</span></span>
<span><span class="co"># Mann-Whitney U Test</span></span>
<span><span class="fu"><a href="../reference/cyt_ttest.html">cyt_ttest</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mann-Whitney U test p-value for PreT2D vs T2D on IFN.G: 0.008462</span></span>
<span><span class="co">#&gt; Mann-Whitney U test p-value for PreT2D vs T2D on IL.10: 0.01191</span></span>
<span><span class="co">#&gt; Mann-Whitney U test p-value for CD3/CD28 vs LPS on IFN.G: 5.915e-19</span></span>
<span><span class="co">#&gt; Mann-Whitney U test p-value for CD3/CD28 vs LPS on IL.10: 3.278e-05</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="anova-comparisons-test">ANOVA Comparisons Test<a class="anchor" aria-label="anchor" href="#anova-comparisons-test"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform ANOVA comparisons test (example with 2 cytokines)</span></span>
<span><span class="fu"><a href="../reference/cyt_anova.html">cyt_anova</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $IFN.G_Group</span></span>
<span><span class="co">#&gt; [1] 0.00356939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $IL.10_Group</span></span>
<span><span class="co">#&gt; [1] 0.003323717</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $IFN.G_Treatment</span></span>
<span><span class="co">#&gt; [1] 3.805612e-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $IL.10_Treatment</span></span>
<span><span class="co">#&gt; [1] 0.0002059574</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-analysis">6. Multivariate Analysis<a class="anchor" aria-label="anchor" href="#multivariate-analysis"></a>
</h3>
<div class="section level4">
<h4 id="partial-least-squares-discriminant-analysis-pls-da">Partial Least Squares Discriminant Analysis (PLS-DA)<a class="anchor" aria-label="anchor" href="#partial-least-squares-discriminant-analysis-pls-da"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In this code, we will have background predict to be turned on to see the classification areas and </span></span>
<span><span class="co"># we will also print out the confusion matrix based on classification. </span></span>
<span><span class="co"># Note this takes into account all groups and treatment and all values are log transformed through </span></span>
<span><span class="co"># cyt.plsda function. </span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span></span>
<span><span class="fu"><a href="../reference/cyt_splsda.html">cyt_splsda</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>          pdf_title <span class="op">=</span> <span class="st">"example_spls_da_analysis.pdf"</span>, </span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"red2"</span><span class="op">)</span>,</span>
<span>          bg <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="st">"log2"</span>, </span>
<span>          conf_mat <span class="op">=</span> <span class="cn">TRUE</span>, var_num <span class="op">=</span> <span class="fl">25</span>, </span>
<span>          cv_opt <span class="op">=</span> <span class="st">"loocv"</span>,</span>
<span>          comp_num <span class="op">=</span> <span class="fl">3</span>, pch_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>          style <span class="op">=</span> <span class="st">"3d"</span>, </span>
<span>          group_col <span class="op">=</span> <span class="st">"Group"</span>, trt_col <span class="op">=</span> <span class="st">"Treatment"</span>, </span>
<span>          roc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Results based on log2 transformation:"</span></span>
<span><span class="co">#&gt; [1] "CD3/CD28 LOOCV Accuracy: 49%"</span></span>
<span><span class="co">#&gt; [1] "CD3/CD28 LOOCV Accuracy (VIP&gt;1): 52%"</span></span>
<span><span class="co">#&gt; [1] "LPS LOOCV Accuracy: 44%"</span></span>
<span><span class="co">#&gt; [1] "LPS LOOCV Accuracy (VIP&gt;1): 44%"</span></span>
<span><span class="co">#&gt; [1] "Unstimulated LOOCV Accuracy: 34%"</span></span>
<span><span class="co">#&gt; [1] "Unstimulated LOOCV Accuracy (VIP&gt;1): 42%"</span></span>
<span><span class="co">#&gt; Overall Confusion Matrix for PLS-DA Comparison</span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction ND PreT2D T2D</span></span>
<span><span class="co">#&gt;     ND      6      4   6</span></span>
<span><span class="co">#&gt;     PreT2D 13     27   9</span></span>
<span><span class="co">#&gt;     T2D    14      2  18</span></span>
<span><span class="co">#&gt; Accuracy: 0.52 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Per-Class Sensitivity:</span></span>
<span><span class="co">#&gt;     Class: ND Class: PreT2D    Class: T2D </span></span>
<span><span class="co">#&gt;          0.18          0.82          0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Per-Class Specificity:</span></span>
<span><span class="co">#&gt;     Class: ND Class: PreT2D    Class: T2D </span></span>
<span><span class="co">#&gt;          0.85          0.67          0.76 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Macro-Averaged Sensitivity: 0.52 </span></span>
<span><span class="co">#&gt; Macro-Averaged Specificity: 0.76 </span></span>
<span><span class="co">#&gt; Overall Confusion Matrix for PLS-DA Comparison with VIP Score &gt; 1</span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction ND PreT2D T2D</span></span>
<span><span class="co">#&gt;     ND      8      4   7</span></span>
<span><span class="co">#&gt;     PreT2D 12     22   5</span></span>
<span><span class="co">#&gt;     T2D    13      7  21</span></span>
<span><span class="co">#&gt; Accuracy: 0.52 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Per-Class Sensitivity:</span></span>
<span><span class="co">#&gt;     Class: ND Class: PreT2D    Class: T2D </span></span>
<span><span class="co">#&gt;          0.24          0.67          0.64 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Per-Class Specificity:</span></span>
<span><span class="co">#&gt;     Class: ND Class: PreT2D    Class: T2D </span></span>
<span><span class="co">#&gt;          0.83          0.74          0.70 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Macro-Averaged Sensitivity: 0.52 </span></span>
<span><span class="co">#&gt; Macro-Averaged Specificity: 0.76</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="principal-component-analysis-pca">7. Principal Component Analysis (PCA)<a class="anchor" aria-label="anchor" href="#principal-component-analysis-pca"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">24</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Group</span> <span class="op">!=</span> <span class="st">"ND"</span> <span class="op">&amp;</span> <span class="va">Treatment</span> <span class="op">!=</span> <span class="st">"Unstimulated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cyt_pca.html">cyt_pca</a></span><span class="op">(</span><span class="va">data_df</span>, </span>
<span>        pdf_title <span class="op">=</span> <span class="st">"example_pca_analysis.pdf"</span>, </span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red2"</span><span class="op">)</span>, </span>
<span>        scale <span class="op">=</span> <span class="st">"log2"</span>, </span>
<span>        comp_num <span class="op">=</span> <span class="fl">3</span>, pch_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>        style <span class="op">=</span> <span class="st">"3D"</span>, group_col <span class="op">=</span> <span class="st">"Group"</span>, trt_col <span class="op">=</span> <span class="st">"Treatment"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Results based on log2 transformation:"</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span>
<span><span class="fu"><a href="../reference/cyt_pca.html">cyt_pca</a></span><span class="op">(</span><span class="va">data_df</span>, </span>
<span>        pdf_title <span class="op">=</span> <span class="st">"example_pca_analysis_2.pdf"</span>, </span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red2"</span><span class="op">)</span>, </span>
<span>        scale <span class="op">=</span> <span class="st">"log2"</span>, </span>
<span>        comp_num <span class="op">=</span> <span class="fl">2</span>, pch_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>        group_col <span class="op">=</span> <span class="st">"Group"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Results based on log2 transformation:"</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="volcano-plot">8. Volcano Plot<a class="anchor" aria-label="anchor" href="#volcano-plot"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating Volcano Plot</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">volc_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_volc.html">cyt_volc</a></span><span class="op">(</span><span class="va">data_df</span>, group_col <span class="op">=</span> <span class="st">"Group"</span>, </span>
<span>                      cond1 <span class="op">=</span> <span class="st">"T2D"</span>, cond2 <span class="op">=</span> <span class="st">"ND"</span>, </span>
<span>                      fold_change_thresh <span class="op">=</span> <span class="fl">2.0</span>, </span>
<span>                      top_labels <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    cytokine      fc_log      p_log significant</span></span>
<span><span class="co">#&gt; IL.12.P70         IL.12.P70 -2.60117683 2.18641971        TRUE</span></span>
<span><span class="co">#&gt; IL.6                   IL.6 -0.95013174 3.94758527       FALSE</span></span>
<span><span class="co">#&gt; IL.27                 IL.27 -0.67878724 2.33099419       FALSE</span></span>
<span><span class="co">#&gt; IL.23                 IL.23 -0.87320747 1.95290632       FALSE</span></span>
<span><span class="co">#&gt; CCL.20.MIP.3A CCL.20.MIP.3A -0.48569948 1.40917287       FALSE</span></span>
<span><span class="co">#&gt; IL.2                   IL.2 -0.80577278 1.22848122       FALSE</span></span>
<span><span class="co">#&gt; IL.17F               IL.17F -0.93024059 1.16938373       FALSE</span></span>
<span><span class="co">#&gt; IL.10                 IL.10 -0.48121242 1.01734902       FALSE</span></span>
<span><span class="co">#&gt; IL.28A               IL.28A -0.31081278 0.98351262       FALSE</span></span>
<span><span class="co">#&gt; IL.17A               IL.17A -0.80415853 0.90173665       FALSE</span></span>
<span><span class="co">#&gt; IL.1B                 IL.1B -0.61564856 0.83381951       FALSE</span></span>
<span><span class="co">#&gt; GM.CSF               GM.CSF  0.45980342 0.62042612       FALSE</span></span>
<span><span class="co">#&gt; IL.21                 IL.21 -0.62254771 0.51843946       FALSE</span></span>
<span><span class="co">#&gt; IL.17E.IL.25   IL.17E.IL.25  0.01449957 0.49515782       FALSE</span></span>
<span><span class="co">#&gt; IL.22                 IL.22 -0.30363695 0.47550506       FALSE</span></span>
<span><span class="co">#&gt; IL.9                   IL.9 -0.32752255 0.43117675       FALSE</span></span>
<span><span class="co">#&gt; TNF.A                 TNF.A -0.15647551 0.21142412       FALSE</span></span>
<span><span class="co">#&gt; IL.31                 IL.31  0.21056699 0.20929529       FALSE</span></span>
<span><span class="co">#&gt; IL.4                   IL.4  0.21161574 0.20542291       FALSE</span></span>
<span><span class="co">#&gt; IL.5                   IL.5 -0.20808037 0.17512546       FALSE</span></span>
<span><span class="co">#&gt; IL.15                 IL.15 -0.05298748 0.12055764       FALSE</span></span>
<span><span class="co">#&gt; IL.13                 IL.13 -0.07717527 0.06654004       FALSE</span></span>
<span><span class="co">#&gt; IFN.G                 IFN.G -0.09088794 0.06221451       FALSE</span></span>
<span><span class="co">#&gt; TNF.B                 TNF.B  0.07037796 0.05224667       FALSE</span></span>
<span><span class="co">#&gt; IL.33                 IL.33  0.01213249 0.01719622       FALSE</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"volcano_plot.png"</span>, plot <span class="op">=</span> <span class="va">volc_plot</span><span class="op">$</span><span class="va">`T2D vs ND`</span>, </span>
<span>       dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="co"># Print the final plot data (excluding the label column)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">volc_plot</span><span class="op">$</span><span class="va">`T2D vs ND`</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    cytokine      fc_log      p_log significant         label</span></span>
<span><span class="co">#&gt; IL.12.P70         IL.12.P70 -2.60117683 2.18641971        TRUE     IL.12.P70</span></span>
<span><span class="co">#&gt; IL.6                   IL.6 -0.95013174 3.94758527       FALSE          IL.6</span></span>
<span><span class="co">#&gt; IL.27                 IL.27 -0.67878724 2.33099419       FALSE         IL.27</span></span>
<span><span class="co">#&gt; IL.23                 IL.23 -0.87320747 1.95290632       FALSE         IL.23</span></span>
<span><span class="co">#&gt; CCL.20.MIP.3A CCL.20.MIP.3A -0.48569948 1.40917287       FALSE CCL.20.MIP.3A</span></span>
<span><span class="co">#&gt; IL.2                   IL.2 -0.80577278 1.22848122       FALSE          IL.2</span></span>
<span><span class="co">#&gt; IL.17F               IL.17F -0.93024059 1.16938373       FALSE        IL.17F</span></span>
<span><span class="co">#&gt; IL.10                 IL.10 -0.48121242 1.01734902       FALSE         IL.10</span></span>
<span><span class="co">#&gt; IL.28A               IL.28A -0.31081278 0.98351262       FALSE        IL.28A</span></span>
<span><span class="co">#&gt; IL.17A               IL.17A -0.80415853 0.90173665       FALSE        IL.17A</span></span>
<span><span class="co">#&gt; IL.1B                 IL.1B -0.61564856 0.83381951       FALSE         IL.1B</span></span>
<span><span class="co">#&gt; GM.CSF               GM.CSF  0.45980342 0.62042612       FALSE        GM.CSF</span></span>
<span><span class="co">#&gt; IL.21                 IL.21 -0.62254771 0.51843946       FALSE         IL.21</span></span>
<span><span class="co">#&gt; IL.17E.IL.25   IL.17E.IL.25  0.01449957 0.49515782       FALSE  IL.17E.IL.25</span></span>
<span><span class="co">#&gt; IL.22                 IL.22 -0.30363695 0.47550506       FALSE         IL.22</span></span>
<span><span class="co">#&gt; IL.9                   IL.9 -0.32752255 0.43117675       FALSE              </span></span>
<span><span class="co">#&gt; TNF.A                 TNF.A -0.15647551 0.21142412       FALSE              </span></span>
<span><span class="co">#&gt; IL.31                 IL.31  0.21056699 0.20929529       FALSE              </span></span>
<span><span class="co">#&gt; IL.4                   IL.4  0.21161574 0.20542291       FALSE              </span></span>
<span><span class="co">#&gt; IL.5                   IL.5 -0.20808037 0.17512546       FALSE              </span></span>
<span><span class="co">#&gt; IL.15                 IL.15 -0.05298748 0.12055764       FALSE              </span></span>
<span><span class="co">#&gt; IL.13                 IL.13 -0.07717527 0.06654004       FALSE              </span></span>
<span><span class="co">#&gt; IFN.G                 IFN.G -0.09088794 0.06221451       FALSE              </span></span>
<span><span class="co">#&gt; TNF.B                 TNF.B  0.07037796 0.05224667       FALSE              </span></span>
<span><span class="co">#&gt; IL.33                 IL.33  0.01213249 0.01719622       FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="heatmap">9. Heatmap<a class="anchor" aria-label="anchor" href="#heatmap"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating Heat map</span></span>
<span><span class="fu"><a href="../reference/cyt_heatmap.html">cyt_heatmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_df</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log2"</span>,        <span class="co"># Optional scaling</span></span>
<span>            annotation_col_name <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"heatmap.png"</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dual-flashlight-plot">10. Dual Flashlight Plot<a class="anchor" aria-label="anchor" href="#dual-flashlight-plot"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating dual flashlights plot</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">cytodata</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dfp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_dualflashplot.html">cyt_dualflashplot</a></span><span class="op">(</span><span class="va">data_df</span>, group_var <span class="op">=</span> <span class="st">"Group"</span>, </span>
<span>                         group1 <span class="op">=</span> <span class="st">"T2D"</span>, group2 <span class="op">=</span> <span class="st">"ND"</span>, </span>
<span>                         ssmd_thresh <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, log2fc_thresh <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                         top_labels <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 Ã— 11</span></span></span>
<span><span class="co">#&gt;    cytokine         mean_ND mean_PreT2D   mean_T2D variance_ND variance_PreT2D</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> CCL.20.MIP.3A   634.        404.       887.        6.72<span style="color: #949494;">e</span>+ 5         2.74<span style="color: #949494;">e</span>+5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> GM.CSF            2.65        3.11       1.92      2.63<span style="color: #949494;">e</span>+ 1         3.14<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> IFN.G         <span style="text-decoration: underline;">57</span>730.      <span style="text-decoration: underline;">18</span>303.     <span style="text-decoration: underline;">61</span>484.        2.86<span style="color: #949494;">e</span>+10         2.30<span style="color: #949494;">e</span>+9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> IL.10           979.        836.      <span style="text-decoration: underline;">1</span>366.        1.99<span style="color: #949494;">e</span>+ 6         1.19<span style="color: #949494;">e</span>+6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> IL.12.P70        13.0        39.1       78.9       4.15<span style="color: #949494;">e</span>+ 2         2.56<span style="color: #949494;">e</span>+4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> IL.13          <span style="text-decoration: underline;">1</span>064.       <span style="text-decoration: underline;">1</span>543.      <span style="text-decoration: underline;">1</span>122.        5.60<span style="color: #949494;">e</span>+ 6         1.11<span style="color: #949494;">e</span>+7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> IL.15             7.92        4.29       8.22      3.54<span style="color: #949494;">e</span>+ 1         2.58<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> IL.17A          352.        653.       615.        9.40<span style="color: #949494;">e</span>+ 5         2.88<span style="color: #949494;">e</span>+6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> IL.17E.IL.25      0.010<span style="text-decoration: underline;">1</span>      0.016<span style="text-decoration: underline;">3</span>     0.01      1.01<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>         3.88<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> IL.17F            1.63        2.35       3.11      1.56<span style="color: #949494;">e</span>+ 1         3.37<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> IL.1B          <span style="text-decoration: underline;">2</span>806.       <span style="text-decoration: underline;">2</span>977.      <span style="text-decoration: underline;">4</span>299.        6.63<span style="color: #949494;">e</span>+ 7         3.76<span style="color: #949494;">e</span>+7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> IL.2           <span style="text-decoration: underline;">9</span>227.      <span style="text-decoration: underline;">10</span>718.     <span style="text-decoration: underline;">16</span>129.        2.60<span style="color: #949494;">e</span>+ 8         4.10<span style="color: #949494;">e</span>+8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> IL.21           205.        210.       316.        3.15<span style="color: #949494;">e</span>+ 5         2.49<span style="color: #949494;">e</span>+5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> IL.22             0.051<span style="text-decoration: underline;">3</span>      0.068<span style="text-decoration: underline;">4</span>     0.063<span style="text-decoration: underline;">3</span>    4.58<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>         4.51<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> IL.23             0.147       0.243      0.269     3.13<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span>         9.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> IL.27             0.066<span style="text-decoration: underline;">2</span>      0.083<span style="text-decoration: underline;">4</span>     0.106     6.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>         5.66<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> IL.28A            0.053<span style="text-decoration: underline;">7</span>      0.071<span style="text-decoration: underline;">0</span>     0.066<span style="text-decoration: underline;">6</span>    2.45<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>         5.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> IL.31             0.040<span style="text-decoration: underline;">9</span>      0.090<span style="text-decoration: underline;">5</span>     0.035<span style="text-decoration: underline;">4</span>    6.62<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>         4.88<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> IL.33             1.17        1.43       1.16      2.09<span style="color: #949494;">e</span>+ 0         2.71<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> IL.4              0.344       0.707      0.297     4.24<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>         2.96<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> IL.5            134.        340.       155.        1.09<span style="color: #949494;">e</span>+ 5         9.88<span style="color: #949494;">e</span>+5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> IL.6           <span style="text-decoration: underline;">4</span>620.       <span style="text-decoration: underline;">5</span>197.      <span style="text-decoration: underline;">8</span>925.        2.86<span style="color: #949494;">e</span>+ 7         5.72<span style="color: #949494;">e</span>+7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span> IL.9            203.        256.       254.        1.34<span style="color: #949494;">e</span>+ 5         2.11<span style="color: #949494;">e</span>+5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span> TNF.A          <span style="text-decoration: underline;">5</span>046.       <span style="text-decoration: underline;">3</span>069.      <span style="text-decoration: underline;">5</span>624.        7.02<span style="color: #949494;">e</span>+ 7         1.63<span style="color: #949494;">e</span>+7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span> TNF.B             0.641       0.709      0.610     2.37<span style="color: #949494;">e</span>+ 0         2.76<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 5 more variables: variance_T2D &lt;dbl&gt;, ssmd &lt;dbl&gt;, log2FC &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   SSMD_Category &lt;chr&gt;, Significant &lt;lgl&gt;</span></span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"dual_flashlight_plot.png"</span>, plot <span class="op">=</span> <span class="va">dfp</span><span class="op">$</span><span class="va">plot_env</span><span class="op">$</span><span class="va">p</span>, dpi <span class="op">=</span> <span class="fl">300</span>, </span>
<span>       width <span class="op">=</span> <span class="fl">3000</span>, height <span class="op">=</span> <span class="fl">2000</span>, units <span class="op">=</span> <span class="st">"px"</span><span class="op">)</span></span>
<span><span class="co"># Print the table data used for plotting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 Ã— 11</span></span></span>
<span><span class="co">#&gt;    cytokine         mean_ND mean_PreT2D mean_T2D variance_ND variance_PreT2D</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> CCL.20.MIP.3A   634.        404.       887.      6.72<span style="color: #949494;">e</span>+ 5         2.74<span style="color: #949494;">e</span>+5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> GM.CSF            2.65        3.11       1.92    2.63<span style="color: #949494;">e</span>+ 1         3.14<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> IFN.G         <span style="text-decoration: underline;">57</span>730.      <span style="text-decoration: underline;">18</span>303.     <span style="text-decoration: underline;">61</span>484.      2.86<span style="color: #949494;">e</span>+10         2.30<span style="color: #949494;">e</span>+9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> IL.10           979.        836.      <span style="text-decoration: underline;">1</span>366.      1.99<span style="color: #949494;">e</span>+ 6         1.19<span style="color: #949494;">e</span>+6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> IL.12.P70        13.0        39.1       78.9     4.15<span style="color: #949494;">e</span>+ 2         2.56<span style="color: #949494;">e</span>+4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> IL.13          <span style="text-decoration: underline;">1</span>064.       <span style="text-decoration: underline;">1</span>543.      <span style="text-decoration: underline;">1</span>122.      5.60<span style="color: #949494;">e</span>+ 6         1.11<span style="color: #949494;">e</span>+7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> IL.15             7.92        4.29       8.22    3.54<span style="color: #949494;">e</span>+ 1         2.58<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> IL.17A          352.        653.       615.      9.40<span style="color: #949494;">e</span>+ 5         2.88<span style="color: #949494;">e</span>+6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> IL.17E.IL.25      0.010<span style="text-decoration: underline;">1</span>      0.016<span style="text-decoration: underline;">3</span>     0.01    1.01<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>         3.88<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> IL.17F            1.63        2.35       3.11    1.56<span style="color: #949494;">e</span>+ 1         3.37<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 15 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 5 more variables: variance_T2D &lt;dbl&gt;, ssmd &lt;dbl&gt;, log2FC &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   SSMD_Category &lt;chr&gt;, Significant &lt;lgl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="machine-learning-models">11. Machine Learning Models<a class="anchor" aria-label="anchor" href="#machine-learning-models"></a>
</h3>
<div class="section level4">
<h4 id="using-xgboost-for-classification">Using XGBoost for classification<a class="anchor" aria-label="anchor" href="#using-xgboost-for-classification"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using XGBoost for classification</span></span>
<span><span class="va">data_df0</span> <span class="op">&lt;-</span> <span class="va">cytodata</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data_df0</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">data_df0</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="va">data_df</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="va">Group</span> <span class="op">!=</span> <span class="st">"ND"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_xgb.html">cyt_xgb</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_df</span>, group_col <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>                       nrounds <span class="op">=</span> <span class="fl">500</span>, max_depth <span class="op">=</span> <span class="fl">4</span>, eta <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                       nfold <span class="op">=</span> <span class="fl">5</span>, cv <span class="op">=</span> <span class="cn">TRUE</span>, eval_metric <span class="op">=</span> <span class="st">"mlogloss"</span>,</span>
<span>                       early_stopping_rounds <span class="op">=</span> <span class="cn">NULL</span>, top_n_features <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                       verbose <span class="op">=</span> <span class="fl">0</span>, plot_roc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Group to Numeric Label Mapping ###</span></span>
<span><span class="co">#&gt; PreT2D    T2D </span></span>
<span><span class="co">#&gt;      0      1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### TRAINING XGBOOST MODEL ###</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Best iteration from training (based on mlogloss ):</span></span>
<span><span class="co">#&gt;     iter train_mlogloss test_mlogloss</span></span>
<span><span class="co">#&gt;    &lt;num&gt;          &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   313     0.01860717     0.4529601</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AUC:  0.9155767</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Confusion Matrix on Test Set ###</span></span>
<span><span class="co">#&gt; Confusion Matrix and Statistics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction  0  1</span></span>
<span><span class="co">#&gt;          0 25  7</span></span>
<span><span class="co">#&gt;          1  4 22</span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;                Accuracy : 0.8103          </span></span>
<span><span class="co">#&gt;                  95% CI : (0.6859, 0.9013)</span></span>
<span><span class="co">#&gt;     No Information Rate : 0.5             </span></span>
<span><span class="co">#&gt;     P-Value [Acc &gt; NIR] : 1.016e-06       </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;                   Kappa : 0.6207          </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;  Mcnemar's Test P-Value : 0.5465          </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;             Sensitivity : 0.8621          </span></span>
<span><span class="co">#&gt;             Specificity : 0.7586          </span></span>
<span><span class="co">#&gt;          Pos Pred Value : 0.7812          </span></span>
<span><span class="co">#&gt;          Neg Pred Value : 0.8462          </span></span>
<span><span class="co">#&gt;              Prevalence : 0.5000          </span></span>
<span><span class="co">#&gt;          Detection Rate : 0.4310          </span></span>
<span><span class="co">#&gt;    Detection Prevalence : 0.5517          </span></span>
<span><span class="co">#&gt;       Balanced Accuracy : 0.8103          </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;        'Positive' Class : 0               </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Top 10 Important Features ###</span></span>
<span><span class="co">#&gt;           Feature       Gain      Cover  Frequency</span></span>
<span><span class="co">#&gt;            &lt;char&gt;      &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:         TNF.A 0.18457678 0.10535233 0.09103448</span></span>
<span><span class="co">#&gt;  2:         IL.22 0.15117263 0.16064281 0.09885057</span></span>
<span><span class="co">#&gt;  3:     IL.12.P70 0.09955532 0.12855158 0.12321839</span></span>
<span><span class="co">#&gt;  4:         IL.33 0.09384522 0.08514973 0.07908046</span></span>
<span><span class="co">#&gt;  5:         IL.1B 0.07717208 0.03835908 0.05149425</span></span>
<span><span class="co">#&gt;  6:          IL.9 0.07554566 0.06955229 0.07080460</span></span>
<span><span class="co">#&gt;  7:         IL.15 0.04705740 0.05853239 0.03310345</span></span>
<span><span class="co">#&gt;  8:         IL.23 0.04440949 0.02533791 0.02988506</span></span>
<span><span class="co">#&gt;  9: CCL.20.MIP.3A 0.03678675 0.05623800 0.05287356</span></span>
<span><span class="co">#&gt; 10:         IL.13 0.02785650 0.02633047 0.03678161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### CROSS-VALIDATION USING XGBOOST ###</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Best iteration from cross-validation:</span></span>
<span><span class="co">#&gt;     iter train_mlogloss_mean train_mlogloss_std test_mlogloss_mean</span></span>
<span><span class="co">#&gt;    &lt;num&gt;               &lt;num&gt;              &lt;num&gt;              &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    45           0.1664957         0.01796909           0.457419</span></span>
<span><span class="co">#&gt;    test_mlogloss_std</span></span>
<span><span class="co">#&gt;                &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:        0.08743712</span></span>
<span><span class="co">#&gt; Confusion Matrix and Statistics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction  0  1</span></span>
<span><span class="co">#&gt;          0 57 13</span></span>
<span><span class="co">#&gt;          1 13 57</span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt;                Accuracy : 0.8143         </span></span>
<span><span class="co">#&gt;                  95% CI : (0.7398, 0.875)</span></span>
<span><span class="co">#&gt;     No Information Rate : 0.5            </span></span>
<span><span class="co">#&gt;     P-Value [Acc &gt; NIR] : 1.212e-14      </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt;                   Kappa : 0.6286         </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt;  Mcnemar's Test P-Value : 1              </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt;             Sensitivity : 0.8143         </span></span>
<span><span class="co">#&gt;             Specificity : 0.8143         </span></span>
<span><span class="co">#&gt;          Pos Pred Value : 0.8143         </span></span>
<span><span class="co">#&gt;          Neg Pred Value : 0.8143         </span></span>
<span><span class="co">#&gt;              Prevalence : 0.5000         </span></span>
<span><span class="co">#&gt;          Detection Rate : 0.4071         </span></span>
<span><span class="co">#&gt;    Detection Prevalence : 0.5000         </span></span>
<span><span class="co">#&gt;       Balanced Accuracy : 0.8143         </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt;        'Positive' Class : 0              </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cross-Validation Accuracy:  0.8142857</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="using-random-forest-for-classification">Using Random Forest for classification<a class="anchor" aria-label="anchor" href="#using-random-forest-for-classification"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Random Forest for classification</span></span>
<span><span class="va">rf_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyt_rf.html">cyt_rf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_df</span>, group_col <span class="op">=</span> <span class="st">"Group"</span>, k_folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                     ntree <span class="op">=</span> <span class="fl">1000</span>, mtry <span class="op">=</span> <span class="fl">4</span>, run_rfcv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     plot_roc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### RANDOM FOREST RESULTS ON TRAINING SET ###</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  randomForest(formula = formula_rf, data = train_data, ntree = ntree,      mtry = mtry, importance = TRUE) </span></span>
<span><span class="co">#&gt;                Type of random forest: classification</span></span>
<span><span class="co">#&gt;                      Number of trees: 1000</span></span>
<span><span class="co">#&gt; No. of variables tried at each split: 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         OOB estimate of  error rate: 11.43%</span></span>
<span><span class="co">#&gt; Confusion matrix:</span></span>
<span><span class="co">#&gt;        PreT2D T2D class.error</span></span>
<span><span class="co">#&gt; PreT2D     62   8   0.1142857</span></span>
<span><span class="co">#&gt; T2D         8  62   0.1142857</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Accuracy on training set:  0.8857143 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Class 'PreT2D' metrics:</span></span>
<span><span class="co">#&gt;   Sensitivity:  0.886 </span></span>
<span><span class="co">#&gt;   Specificity:  0.886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Class 'T2D' metrics:</span></span>
<span><span class="co">#&gt;   Sensitivity:  0.886 </span></span>
<span><span class="co">#&gt;   Specificity:  0.886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### PREDICTIONS ON TEST SET ###</span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction PreT2D T2D</span></span>
<span><span class="co">#&gt;     PreT2D     25   7</span></span>
<span><span class="co">#&gt;     T2D         4  22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Accuracy on test set:  0.8103448 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sensitivity by class:</span></span>
<span><span class="co">#&gt; Class: PreT2D: 0.862</span></span>
<span><span class="co">#&gt; Class: T2D: 0.241</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Specificity by class:</span></span>
<span><span class="co">#&gt; Class: T2D: 0.759</span></span>
<span><span class="co">#&gt; Class: PreT2D: 0.138</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AUC:  0.9298454</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### RANDOM FOREST CROSS-VALIDATION FOR FEATURE SELECTION ###</span></span>
<span><span class="co">#&gt; Random Forest CV completed for feature selection.</span></span>
<span><span class="co">#&gt;         Check the plot for error vs. number of variables.</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shubh Saraswat, Xiaohua Douglas Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
